
---
title: Rust(1) åŸºæœ¬è¯­æ³•
date: 2019-10-22
categories:  
    - Programing
    - Rust
tags:
    - Series-Rust
---
ä½¿ç”¨rustè¯­è¨€ç¼–å†™hello worldå†å®¹æ˜“ä¸è¿‡äº†ï¼š
```rust
fn main() {
    println!("Hello world!");
}
```
ç„¶ååˆ©ç”¨rustcç¼–è¯‘å™¨ç¼–è¯‘å³å¯:
```bash
rustc hell.rs -o hello.out && ./hello.out
```
<!-- more -->
# å¯å˜(mutable)ä¸ä¸å¯å˜(immutable)
rustç¨‹åºé»˜è®¤çš„å˜é‡æ˜¯ä¸å¯å˜çš„ï¼Œç±»ä¼¼Scalaè¿™ç§å‡½æ•°å¼ç¼–ç¨‹çš„è¯­è¨€ï¼Œé¼“åŠ±ç”¨æˆ·ä½¿ç”¨immutableçš„å˜é‡ã€‚å½“ç„¶å¦‚æœä½ éæƒ³è¦ä½¿ç”¨å¯å˜çš„å¯¹è±¡ä¹Ÿæ˜¯æ”¯æŒçš„ï¼š

```rust
let i = 32; // immutable
let mut i = 32;
```
ç¼–è¯‘å™¨ä¼šæ£€æŸ¥æ˜¯å¦å¯¹ä¸å¯å˜å¯¹è±¡é‡æ–°èµ‹å€¼:

```
  |
4 |     let i = 10;
  |         -
  |         |
  |         first assignment to `i`
  |         help: make this binding mutable: `mut i`
...
7 |     i = 99;
  |     ^^^^^^ cannot assign twice to immutable variable
  ```

é‚£ä¹ˆï¼Œå¯¹äºç®€å•ç±»å‹ç›´æ¥èµ‹å€¼ä¼šæœ‰é—®é¢˜ï¼Œå¦‚æœæ˜¯å¤æ‚ç±»å‹ï¼Œå¦‚ä½•å‘¢ï¼Ÿæ¯”å¦‚æˆ‘ä»¬ç”¨ä¸€ä¸ªä¸å¯å˜çš„å­—ç¬¦ä¸²ï¼Œç„¶åå»è°ƒç”¨å®ƒçš„å‡½æ•°æ”¹å˜å€¼ï¼Œä¼šå‘ç”Ÿç”Ÿä¹ˆæƒ…å†µå‘¢ï¼Ÿ

```
--> test.rs:5:5
  |
4 |     let s = String::from("hello");
  |         - help: consider changing this to be mutable: `mut s`
5 |     s.push_str(" world!!!");
  |     ^ cannot borrow as mutable

```
ç»“æœè¡¨æ˜ï¼Œrustä¾ç„¶ä¿æŒå¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚çœ‹äº†ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„å®šä¹‰ï¼Œæœ‰äº›è¹Šè··ï¼š
```rust
pub fn push_str(&mut self, string: &str) {
    self.vec.extend_from_slice(string.as_bytes())
}
```
å…·ä½“æ€ä¹ˆåšåˆ°çš„ï¼Œæˆ‘ä»¬åé¢å†æ¥ç ”ç©¶ã€‚

# åŸºæœ¬ç±»å‹
rustè·Ÿå¤§å¤šæ•°ç¼–è¯‘å‹è¯­è¨€ä¸€æ ·æ˜¯é™æ€ç±»å‹(statically typed)çš„è¯­è¨€ï¼Œå³æ‰€æœ‰çš„å˜é‡çš„ç±»å‹åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™å°±æ˜¯å·²çŸ¥çš„ã€‚åœ¨rustè¯­è¨€ä¸­ï¼Œæœ‰ç€å¦‚ä¸‹çš„åŸºæœ¬ç±»å‹ï¼š

## æ ‡é‡ç±»å‹(Scalar types)

ç±»å‹          é•¿åº¦
------------ -------- ----------------------------------------
bool         1        true/ false
char         4        å¹¶ä¸ç­‰åŒäºUnicode
i8/u8        8
i16/u16      16
i32/u32      32       i32æ˜¯é»˜è®¤ç±»å‹ï¼Œé€šå¸¸æ‹¥æœ‰æœ€å¿«çš„é€Ÿåº¦
i64/u64      64
i128/u128    128
isize/usize  arch     å–å†³äºæœºå™¨æ¶æ„ï¼Œåœ¨32ä½æœºå™¨ä¸Šä½32ä½ï¼Œ64ä½ä¸Šä½64ä½
f32          32       æµ®ç‚¹æ•°ä½¿ç”¨IEEE-754æ ‡å‡†
f64          64

```rust
let f = true;
let sum:i32 = 100;
let heart_eyed_cat = 'ğŸ˜»';
```
## å¤åˆç±»å‹(Compound types)

å¤åˆç±»å‹åˆ†ä¸ºå…ƒç»„ï¼ˆTupleï¼‰å’Œæ•°ç»„ã€‚å…ƒç»„å¯ä»¥ç”¨æ¥å°†ä¸åŒç±»å‹çš„è§£æ„ç»„åˆåˆ°ä¸€èµ·ï¼š

```rust
let t: (i32, bool) = (100, false);

let (x, y) = t; // è§£æ„å…ƒç»„
let x = t.0;    // æˆ–è€…é€šè¿‡åºå·è®¿é—®
```

æ•°ç»„çš„ä¸å…ƒç»„çš„åŒºåˆ«åœ¨äºæ•°ç»„ä¸­åŒ…å«çš„éƒ½æ˜¯åŒä¸€ç§æ•°æ®ç±»å‹çš„å€¼ã€‚

```rust
let a = [1, 2, 3];
let a: [i32; 5] = [1, 2, 3, 4, 5]; // æ˜¾ç¤ºå£°æ˜ä¸€ä¸ªæ•°ç»„
let b = [10; 5];                   // å£°æ˜åˆå§‹å€¼ä¸º10ã€é•¿åº¦ä¸º5çš„æ•°ç»„
```
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨rustä¸­å…ƒç»„å’Œæ•°ç»„éƒ½æ˜¯å›ºå®šé•¿åº¦çš„ï¼Œä¸€æ—¦å£°æ˜ä»¥åå°±ä¸å¯ä»¥æ›´æ”¹ã€‚å¦‚æœéè¦å¯å˜é•¿åº¦çš„é›†åˆï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‡å‡†åº“ä¸­çš„`vector`ã€‚å¹¶ä¸”æ•°ç»„ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯ä¸å¯ä»¥æ›´æ”¹çš„ï¼Œå¦‚æœå°è¯•å»æ›´æ”¹ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡ç¼–è¯‘æ—¶ä¼šå‡ºé”™ï¼š

```
6 |     let b = [100; 5];
  |         - help: consider changing this to be mutable: `mut b`
7 |     b[1] = 1024;
  |     ^^^^^^^^^^^ cannot assign
```
è¿™å’Œä¸€äº›å…¶ä»–çš„è¯­è¨€(ä¾‹å¦‚Javaä¸­çš„final)æ˜¯æœ‰åŒºåˆ«çš„ã€‚

æ•°ç»„ä¸­å¦‚æœå¦‚æœå£°æ˜çš„é•¿åº¦å’Œå’Œå®é™…å€¼çš„é•¿åº¦ä¸ä¸€æ ·ä¼šæ€æ ·å‘¢ï¼Ÿruståœ¨ç¼–è¯‘æ—¶å°±ä¼šå‡ºé”™ï¼š

```
 --> hell.rs:11:23
   |
11 |     let a: [i32; 3] = [1];
   |                       ^^^ expected an array with a fixed size of 3 elements, found one with 1 element
```

å¦å¤–ï¼Œrustç¨‹åºä¼šåœ¨è¿è¡Œæ—¶å¯¹æ•°ç»„çš„è¾¹ç•Œè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœè¶Šç•Œè®¿é—®æ•°ç»„å°†æŠ›å‡ºé”™è¯¯è€Œç»“æŸç¨‹åºï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªé”™è¯¯çš„å†…å­˜ã€‚

# æ–¹æ³•
åœ¨rustä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨`fn`å…³é”®å­—å®šä¹‰ï¼š

```rust
fn foo(i: i32, j: i32) {
    let sum = i + j
}

// å¸¦æœ‰è¿”å›å€¼çš„æ–¹æ³•
fn sum(i: i32, j: i32) -> i32 {
    i + j
}
```

åœ¨rustä¸­æ–¹æ³•æ˜¯ç¬¬ä¸€ç±»å€¼ï¼Œæ„å‘³ç€ä½ å¯ä»¥è¿™æ ·æ“ä½œï¼š
```rust
let fn_s  = sum;
let s = fn_s(i, j);
```

å¦å¤–ï¼Œæ–¹æ³•ä¸­åŒ…å«åœ¨å¤§æ‹¬å·ä¸­çš„è¯­å¥å—ï¼Œè¢«ç§°ä½œæ˜¯è¡¨è¾¾å¼(expression)ï¼Œå¯ä»¥è¿™æ ·ç”¨ï¼š

```rust
let a = {
   e + 10
};
println!("{}", a);
```

# æµç¨‹æ§åˆ¶

## ifè¯­å¥

rustçš„ifè¯­å¥å’Œå…¶ä»–è¯­è¨€åŸºæœ¬ç±»ä¼¼ï¼Œç¨å¾®æœ‰ä¸€ç‚¹åŒºåˆ«ï¼š

```rust
if e % 2 == 0 {        // ifæ¡ä»¶åé¢ä¸ç”¨å†™å°æ‹¬å·
    println!("{}", e);
} else if e % 3 == 0 { // ä½†æ˜¯åé¢çš„è¯­å¥å—å¿…é¡»åŒ…å«åœ¨å¤§æ‹¬å·ä¹‹ä¸­ï¼Œå“ªæ€•åªæœ‰ä¸€è¡Œ
    println!("{} % 3 ==0", e);
} else {
    println!(":p");
}
```

## æ¡ä»¶èµ‹å€¼

å› ä¸ºifè¯­å¥æœ¬èº«æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å¯ä»¥æŠŠifå’Œletè”åˆåœ¨ä¸€èµ·æ¥ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯æ¡ä»¶èµ‹å€¼ï¼š
```rust
let a = if condition {
    5
} else {
    6
};
```
å½“ç„¶å‰ææ˜¯ä¸åŒçš„åˆ†æ”¯ä¸‹çš„è¯­å¥è¦æ˜¯ä¸€æ ·çš„ç±»å‹ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæ£€æµ‹å‡ºé”™è¯¯ã€‚

## å¾ªç¯
rustçš„`loop`å…³é”®å­—æ”¯æŒåˆ›å»ºä¸€ä¸ªå¾ªç¯:
```rust
let mut i = 0;
loop {
    i += 1;
    println!("->{}", i);
}
```
åŸºæœ¬ä¸Šè¿™å°±æ˜¯ä¸€ä¸ªæ­»å¾ªç¯äº†ã€‚ä¸çŸ¥é“ä¸ºå•¥è¦å®šä¹‰è¿™æ ·ä¸€ä¸ªå¥‡è‘©çš„å…³é”®å­—ã€‚ç´¢æ€§æˆ‘ä»¬å¯ä»¥åƒå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸€æ ·`break`ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè·Ÿæ¡ä»¶èµ‹å€¼ä¸€æ ·ï¼Œloopè¯­å¥ä¹Ÿæ˜¯å¯ä»¥å’Œletä¸€èµ·æ¥èµ‹å€¼çš„ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š

```rust
let s = loop {
    i += 1;
    println!("->{}", i);
    if(i > 100) {
        break i;
    }
};
println!("s = {}", s); // s = 101
```

é™¤äº†è¿™ä¸ª`loop`å¤–ï¼Œä¹Ÿå¯ä»¥â€œæ­£å¸¸çš„â€åƒå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œä½¿ç”¨`while`å’Œ`for`è¿›è¡Œæ¡ä»¶å¾ªç¯ï¼š

```rust
while i < 1000 {    // ä¸ç”¨å†™å°æ‹¬å·
    i += 1;
}

for e in a.iter() { // ä½¿ç”¨forå¾ªç¯éå†æ•°ç»„
    println!("{}", e); 
}

// for i in (1..10).rev()
// ä½¿ç”¨rev()åè½¬é¡ºåº
for i in (1..10) {
    println!("{}", i);
}

```
# rustè¯­è¨€çš„ä¸€äº›æƒ¯ä¾‹

## å‘½åæ–¹å¼

rustä¸­æ¨èä½¿ç”¨è›‡å½¢å‘½å(snake case)æ¥ä½œä¸ºæ–¹æ³•å’Œå˜é‡çš„å‘½åæ–¹å¼ï¼Œæ‰€æœ‰çš„æ ‡è¯†ç¬¦éƒ½æ˜¯å°å†™ä¸”ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”ï¼Œä¾‹å¦‚ï¼š

```rust
let foo_bar = 1;

fn print_info() {

}
```
